---
layout: post    
title: linux内核协议栈研读设计感悟    
date: 2018-9-8    
tags: linux内核协议栈           
---

<br>
### 前言        
对于linux网络协议栈源码研读过程中，对于涉及到的一些设计思想，进行简单记录，同时写下自己的感悟，方便以后进行这种设计思想更加深入的研究、体会、践行。对于文中的观点，只是根据自己的理解和工作中经验进行了简述，会由于自己功力有限或理解偏差产生错误，若是有错误的地方希望能够留下您宝贵的意见和指正。源码主要参考`linux-3.10.0-862.el7.x86_64`版本。        

<br>
### 设计思想     
#### **网络协议栈对skb的存储设计**    
网络协议栈中层与层的传输以及操作，对于系统中skb存储以及设计的要求比较高，主要包括以下几点：    
* 能够很方便地处理可变长缓存，因为接受和发送的数据报长度不是固定的。    
* 能够很容易地实现在头尾部添加和移除数据，因为这些缓存区需要再不同网络层间传递。    
* 在添加和移除数据时能够尽量避免数据的复制。    

根据上述要求，提高网络处理性能。可以考虑从以下几点进行处理：    
* 申请一个固定大小的内存，能够存放各层之间所要的数据。    
* 对于每一层要添加或删除的数据，需要用一个指针进行指向，随着不同层间传输，偏移指针标识每一层的地址即可，再用相应的数据结构进行内存的翻译，随后对相应的变量进行操作。    
    


<br>
参考链接：       


<br> 
转载请注明：[HunterYuan的博客](https://clodfisher.github.io/) » [linux内核协议栈研读设计感悟](https://clodfisher.github.io/2018/09/LinuxNetworkKernelDesign/)              